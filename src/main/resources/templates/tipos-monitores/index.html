<!DOCTYPE html>
<html lang="pt-BR" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout}">
<head>
<meta charset="UTF-8">
<title layout:fragment="titulo">TVON App - Tipos de monitores</title>
</head>
<body>

	<section class="layout-content" layout:fragment="corpo">
		<div class="container">
			<table class="table table-striped table-hover">
				<thead>
					<tr>
						<th>#</th>
						<th>Nome</th>
						<th>Observações</th>
						<th>Ações</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="tipoMonitor : ${tiposMonitores}">
						<td th:text="${tipoMonitor.id}"></td>
						<td th:text="${tipoMonitor.nome}"></td>
						<td>
							<button type="button" class="btn btn-secondary btn-sm"
								data-bs-container="body" data-bs-toggle="popover" data-bs-placement="bottom"
								th:attr="data-bs-content=${tipoMonitor.descricao}">
								<i class="fa-solid fa-eye"></i>
							</button>
						</td>
						<td colspan="2"
							th:with="urlExcluir=@{/tipos-monitores/delete}"><a
							class="btn btn-info btn-sm"
							th:href="@{/tipos-monitores/{id}/edit (id=${tipoMonitor.id})}" role="button">
								<i class="fa-solid fa-pen-to-square"></i>
						</a>
							<button th:id="${'btn-excluir_' + urlExcluir }" type="button"
								class="btn btn-danger btn-sm" th:attr="data-tipomonitor=${tipoMonitor.nome}, data-idmonitor=${tipoMonitor.id}" 
								>
								<i class="fa-solid fa-trash"></i>
							</button></td>
					</tr>
				</tbody>
			</table>
		</div>
		<script type="text/javascript">
	$(document).ready(function(){
		var url = '';
		
		$(function() {
			$('[data-bs-toggle="popover"]').popover();
		});
		
		$('button[id*=btn-excluir_]').click(function(){
			url = "http://localhost:8080" + $(this).attr('id').split("_")[1];
			var confirma = confirm("Deseja exluir tipo " + $(this).data('tipomonitor') + "?");
			var id = $(this).data('idmonitor');
			
			if(confirma) {
				var data = { id : id };
				$.ajax({
					url : url,
					type : "POST",
					contentType: 'application/json',
					data : JSON.stringify(data),
					success: function(response){
						console.log(response);
						var json = JSON.parse(response);
						alert("Excluído com sucesso!");
						window.location.reload();
					},
					
				});
				
			}
			
		});
		
	});
	
	</script>
	</section>
</body>
</html>